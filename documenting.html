
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Documenting projects using brainvisa-cmake &#8212; BrainVisa-Cmake 5.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CMake functions" href="cmake_functions.html" />
    <link rel="prev" title="Testing and monitoring infrastructure" href="testing_monitoring.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cmake_functions.html" title="CMake functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="testing_monitoring.html" title="Testing and monitoring infrastructure"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BrainVisa-Cmake 5.2.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Documenting projects using brainvisa-cmake</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="documenting-projects-using-brainvisa-cmake">
<h1>Documenting projects using brainvisa-cmake<a class="headerlink" href="#documenting-projects-using-brainvisa-cmake" title="Permalink to this heading">¶</a></h1>
<p>Documentation in software projects is supported via external tools like <a class="reference external" href="http://www.doxygen.org">Doxygen</a> or <a class="reference external" href="http://sphinx-doc.org">Sphinx</a>, and are integrated in brainvisa-cmake infrastructure.</p>
<p>Documentation is generated within the <code class="docutils literal notranslate"><span class="pre">doc</span></code> step of <code class="docutils literal notranslate"><span class="pre">bv_maker</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bv_maker doc
</pre></div>
</div>
<p>Alternatively, building documentation can be triggered via the <code class="docutils literal notranslate"><span class="pre">make</span></code> command from a build directory. Several targets control documentation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make doc
</pre></div>
</div>
<p>will build all docs</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make usrdoc
</pre></div>
</div>
<p>will build user documentations</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make devdoc
</pre></div>
</div>
<p>will build development documentations</p>
<p>and generally project-specific targets will exist, like for instance:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make brainvisa-cmake-usrsphinx
make anatomist-free-devdoc
</pre></div>
</div>
<p>etc.</p>
<p>Documentation for a project will be generated in a subdirectory of the build tree, in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/&lt;</span><span class="n">project</span><span class="o">&gt;-&lt;</span><span class="n">version</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="doxygen-documentation">
<h2>Doxygen documentation<a class="headerlink" href="#doxygen-documentation" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="http://www.doxygen.org">Doxygen</a> is used to genrate API documentation for C++ sources. It generates HTML pages, an possibly other formats, which we are not using in <code class="docutils literal notranslate"><span class="pre">brainvisa-cmake</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">brainvisa-cmake</span></code> projects, such documentation should be setup in the <code class="docutils literal notranslate"><span class="pre">CMake</span></code> config files of the project. Typically we set it in the main <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file at the root of the project.</p>
<p>Doxygen docs will be part of the development documentations.</p>
<ul class="simple">
<li><p>The Doxygen component has to be found using <code class="docutils literal notranslate"><span class="pre">find_package(</span> <span class="pre">Doxygen</span> <span class="pre">)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Brainvisa-cmake</span></code> provides a function <a class="reference internal" href="cmake_functions.html#brainvisa-generate-doxygen-doc"><span class="std std-ref">brainvisa_generate_doxygen_doc</span></a> to build Doxygen doc:</p></li>
</ul>
<p>Exaple, from the Cartobase project:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="w"> </span><span class="s">Doxygen</span><span class="w"> </span><span class="p">)</span>
<span class="nb">if</span><span class="p">(</span><span class="w"> </span><span class="s">DOXYGEN_FOUND</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">DOXYFILE_PREDEFINED</span><span class="w"> </span><span class="s2">&quot;${SOMA-IO_DEFINITIONS}&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">_doxyheaders</span><span class="w"> </span><span class="o">${</span><span class="nv">_headers</span><span class="o">}</span><span class="w"> </span><span class="s2">&quot;config/config.h&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="c"># add config.h file</span>
<span class="w">  </span><span class="nb">BRAINVISA_GENERATE_DOXYGEN_DOC</span><span class="p">(</span>
<span class="w">    </span><span class="s">_doxyheaders</span>
<span class="w">    </span><span class="s">INPUT_PREFIX</span><span class="w"> </span><span class="s2">&quot;${CMAKE_BINARY_DIR}/include/cartobase&quot;</span>
<span class="w">    </span><span class="s">COMPONENT</span><span class="w"> </span><span class="s2">&quot;cartobase&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
<p>A more complete example, from Anatomist:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="w"> </span><span class="s">Doxygen</span><span class="w"> </span><span class="p">)</span>
<span class="nb">if</span><span class="p">(</span><span class="w"> </span><span class="s">DOXYGEN_FOUND</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">DOXYFILE_HTML_HEADER</span><span class="w"> </span><span class="s2">&quot;\&quot;</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/head_anatomist.html\</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">_doxygenInput</span><span class="w"> </span><span class="o">${</span><span class="nv">HEADERS</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">DOXYFILE_PREDEFINED</span><span class="w"> </span><span class="o">${</span><span class="nv">ANATOMIST_DEFINITIONS</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">AIMS-FREE_DEFINITIONS</span><span class="o">}</span>
<span class="w">    </span><span class="o">${</span><span class="nv">SOMA-IO_DEFINITIONS</span><span class="o">}</span><span class="w"> </span><span class="s">CARTO_USE_BLITZ</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">aims-free_version</span>
<span class="w">    </span><span class="s2">&quot;${aims-free_VERSION_MAJOR}.${aims-free_VERSION_MINOR}&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">_somaio_version</span><span class="w"> </span><span class="s2">&quot;${soma-io_VERSION_MAJOR}.${soma-io_VERSION_MINOR}&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">DOXYFILE_TAGFILES</span>
<span class="w">    </span><span class="s2">&quot;${CMAKE_BINARY_DIR}/share/doc/aimsgui-${aims-free_version}/doxygen/aimsgui.tag=../../aimsgui-${aims-free_version}/doxygen ${CMAKE_BINARY_DIR}/share/doc/aimsdata-${aims-free_version}/doxygen/aimsdata.tag=../../aimsdata-${aims-free_version}/doxygen ${CMAKE_BINARY_DIR}/share/doc/graph-${aims-free_version}/doxygen/graph.tag=../../graph-${aims-free_version}/doxygen ${CMAKE_BINARY_DIR}/share/doc/cartobase-${_somaio_version}/doxygen/cartobase.tag=../../cartobase-${_somaio_version}/doxygen ${CMAKE_BINARY_DIR}/share/doc/soma-io-${_somaio_version}/doxygen/soma-io.tag=../../cartobase-${_somaio_version}/doxygen ${CMAKE_BINARY_DIR}/share/doc/cartodata-${aims-free_version}/doxygen/cartodata.tag=../../cartodata-${aims-free_version}/doxygen&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">BRAINVISA_GENERATE_DOXYGEN_DOC</span><span class="p">(</span>
<span class="w">    </span><span class="s">_doxygenInput</span>
<span class="w">    </span><span class="s">head_anatomist.html</span><span class="w"> </span><span class="s">anatomist.png</span><span class="w"> </span><span class="s">anatomist.gif</span>
<span class="w">    </span><span class="s">INPUT_PREFIX</span><span class="w"> </span><span class="s2">&quot;${CMAKE_BINARY_DIR}/include/anatomist&quot;</span>
<span class="w">    </span><span class="s">COMPONENT</span><span class="w"> </span><span class="s2">&quot;anatomist&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_dependencies</span><span class="p">(</span><span class="w"> </span><span class="s">anatomist-doxygen</span><span class="w"> </span><span class="s">aimsgui-doxygen</span><span class="w"> </span><span class="s">aimsdata-doxygen</span><span class="w"> </span><span class="s">graph-doxygen</span><span class="w"> </span><span class="s">soma-io-doxygen</span><span class="w"> </span><span class="s">cartobase-doxygen</span><span class="w"> </span><span class="s">cartodata-doxygen</span><span class="w"> </span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="sphinx-documentation">
<h2>Sphinx documentation<a class="headerlink" href="#sphinx-documentation" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="http://sphinx-doc.org">Sphinx</a> is used to build HTML documentation pages. It can be used to make general documentation, and can also make API documentation for Python classes and modules.</p>
<section id="in-cmake-configuration">
<h3>In CMake configuration<a class="headerlink" href="#in-cmake-configuration" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">brainvisa-cmake</span></code> provides a function to build sphinx documentation for a project: <a class="reference internal" href="cmake_functions.html#brainvisa-generate-sphinx-doc"><span class="std std-ref">brainvisa_generate_sphinx_doc</span></a>.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="w"> </span><span class="s">Sphinx</span><span class="w"> </span><span class="p">)</span>
<span class="nb">BRAINVISA_GENERATE_SPHINX_DOC</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;sphinxdoc/user_doc&quot;</span>
<span class="w">  </span><span class="s2">&quot;share/doc/axon-${BRAINVISA_PACKAGE_VERSION_MAJOR}.${BRAINVISA_PACKAGE_VERSION_MINOR}/user_doc&quot;</span><span class="w"> </span><span class="s">USER</span><span class="w"> </span><span class="p">)</span>
<span class="nb">BRAINVISA_GENERATE_SPHINX_DOC</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;sphinxdoc/dev_doc&quot;</span>
<span class="w">  </span><span class="s2">&quot;share/doc/axon-${BRAINVISA_PACKAGE_VERSION_MAJOR}.${BRAINVISA_PACKAGE_VERSION_MINOR}/dev_doc&quot;</span><span class="w"> </span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="in-pure-python-projects">
<h3>In pure python projects<a class="headerlink" href="#in-pure-python-projects" title="Permalink to this heading">¶</a></h3>
<p>In pure python projects, the CMake configuration file is not present in the sources, and is generated by bv_maker. If the project sources contain a directory tree <code class="docutils literal notranslate"><span class="pre">doc/sources</span></code>, then bv_maker will consider it as a Sphinx source directory and configure it to generate sphinx development docs, as in the CMake case.</p>
</section>
<section id="sphinx-sources">
<h3>Sphinx sources<a class="headerlink" href="#sphinx-sources" title="Permalink to this heading">¶</a></h3>
<p>Sphinx sources should be located in a subdirectory of the project sources tree. The directory should contain the <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file expected by sphinx.</p>
<p>For new developers, in a few words, Sphinx sources are text files using a markup language, <a class="reference external" href="http://docutils.sourceforge.net/rst.html">ReStructuredText</a> which is fairly simple and mostly human readable.</p>
<p>The entry point is generally a <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file which may include other ones.</p>
</section>
</section>
<section id="customization">
<h2>Customization<a class="headerlink" href="#customization" title="Permalink to this heading">¶</a></h2>
<p>Using CMake commands, it is possible to mix Doxygen or Sphinx docs with other processings, for instance generation of commandline help, or pre-building of HTML tables etc. All kinds of scripts can be triggered by CMake when generating docs, and the Sphinx builds, especially, may use a part of sources which could be generated by other scripts.</p>
<p>In BrainVisa, we use it for instance to build the complete web site <a class="reference external" href="http://brainvisa.info">http://brainvisa.info</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Documenting projects using brainvisa-cmake</a><ul>
<li><a class="reference internal" href="#doxygen-documentation">Doxygen documentation</a></li>
<li><a class="reference internal" href="#sphinx-documentation">Sphinx documentation</a><ul>
<li><a class="reference internal" href="#in-cmake-configuration">In CMake configuration</a></li>
<li><a class="reference internal" href="#in-pure-python-projects">In pure python projects</a></li>
<li><a class="reference internal" href="#sphinx-sources">Sphinx sources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customization">Customization</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="testing_monitoring.html"
                          title="previous chapter">Testing and monitoring infrastructure</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="cmake_functions.html"
                          title="next chapter">CMake functions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/documenting.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="cmake_functions.html" title="CMake functions"
             >next</a> |</li>
        <li class="right" >
          <a href="testing_monitoring.html" title="Testing and monitoring infrastructure"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BrainVisa-Cmake 5.2.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Documenting projects using brainvisa-cmake</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, CEA.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.0.0.
    </div>
  </body>
</html>