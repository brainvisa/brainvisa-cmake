
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>How to compile a new project with brainvisa-cmake &#8212; BrainVisa-Cmake 5.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dependencies in brainvisa-cmake" href="dependencies.html" />
    <link rel="prev" title="The bv_maker.cfg configuration file" href="configuration.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="dependencies.html" title="Dependencies in brainvisa-cmake"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="The bv_maker.cfg configuration file"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BrainVisa-Cmake 5.1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">How to compile a new project with brainvisa-cmake</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="how-to-compile-a-new-project-with-brainvisa-cmake">
<h1>How to compile a new project with brainvisa-cmake<a class="headerlink" href="#how-to-compile-a-new-project-with-brainvisa-cmake" title="Permalink to this headline">¶</a></h1>
<p>The project must contain 2 files:</p>
<ul>
<li><p><strong>project_info.cmake</strong>: describes the name and version of the project.</p>
<blockquote>
<div><ul class="simple">
<li><p>Alternatively, for a Python project, this file can be replaced by a python file, <strong>info.py</strong> located in a python subdirectory.</p></li>
</ul>
</div></blockquote>
<p>See also the section <a class="reference internal" href="#how-to-create-version-files-with-brainvisa-cmake">How to create version files with brainvisa-cmake</a>.</p>
</li>
<li><p><strong>CMakeLists.txt</strong>: describes the elements which will be generated when the project will be built.</p></li>
</ul>
<p>Moreover, the new project must be declared in bv_maker.cfg to enable its compilation with bv_maker.</p>
<p><strong>Example with a personal project:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[ source $HOME/brainvisa/source ]
  + standard trunk
  + perso/myself/myproject

[ build $HOME/brainvisa/build/trunk ]
  make_options = -j8
  standard trunk $HOME/brainvisa/source
  + $HOME/brainvisa/source/perso/myself/myproject
</pre></div>
</div>
<section id="project-info-cmake">
<h2>Project_info.cmake<a class="headerlink" href="#project-info-cmake" title="Permalink to this headline">¶</a></h2>
<p><strong>Example:</strong> project_info file for <code class="docutils literal notranslate"><span class="pre">anatomist-free</span></code> component of anatomist project.</p>
<p>The following file is in <code class="docutils literal notranslate"><span class="pre">anatomist/anatomist-free/tags/4.5/project_info.cmake</span></code>.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_NAME</span> <span class="s">anatomist-free</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_MAIN_PROJECT</span> <span class="s">anatomist</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_MAINTAINER</span> <span class="s2">&quot;CEA - IFR 49&quot;</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_VERSION_MAJOR</span> <span class="s">4</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_VERSION_MINOR</span> <span class="s">5</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_VERSION_PATCH</span> <span class="s">0</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_LICENCES</span> <span class="s2">&quot;CeCill-B&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p><strong>Example:</strong> project_info file for <code class="docutils literal notranslate"><span class="pre">axon</span></code> project.</p>
<p>The following file is in <code class="docutils literal notranslate"><span class="pre">axon/trunk/project_info.cmake</span></code>.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_NAME</span> <span class="s">axon</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_MAIN_PROJECT</span> <span class="s">axon</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_MAINTAINER</span> <span class="s2">&quot;IFR 49&quot;</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_VERSION_MAJOR</span> <span class="s">4</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_VERSION_MINOR</span> <span class="s">6</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_VERSION_PATCH</span> <span class="s">0</span> <span class="p">)</span>
<span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_LICENCES</span> <span class="s2">&quot;CeCill-V2&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<section id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>A few additional optional variables may be set in project_info.cmake:</p>
<section id="brainvisa-package-default-install">
<h4>BRAINVISA_PACKAGE_DEFAULT_INSTALL<a class="headerlink" href="#brainvisa-package-default-install" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span> <span class="s">BRAINVISA_PACKAGE_DEFAULT_INSTALL</span> <span class="s2">&quot;run&quot;</span> <span class="s2">&quot;usrdoc&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>Specifies that the package should be pre-selectionned for installation in the installer, for its “run” and “usrdoc” categories components.
Packages components are divided into several categories:</p>
<ul class="simple">
<li><p>“run” is the runtime files, used when using the software</p></li>
<li><p>“dev” is the development files, used when developing software using this component as a library</p></li>
<li><p>“test” is the test files, used to test the component (generally only useful for developers)</p></li>
<li><p>“usrdoc” is the user documentation files</p></li>
<li><p>“devdoc” is the development documentation files</p></li>
</ul>
</section>
</section>
<section id="info-py-alternative">
<h3>Info.py alternative<a class="headerlink" href="#info-py-alternative" title="Permalink to this headline">¶</a></h3>
<p>If your project is only using the Python language, you may like to use a python file to describe this information, because it would also be usable in the project code as a python module.</p>
<dl class="simple">
<dt>Thus, alternatively to the <code class="docutils literal notranslate"><span class="pre">project_info.cmake</span></code> file, <em>brainvisa-cmake</em> will look for an <code class="docutils literal notranslate"><span class="pre">info.py</span></code> file, located:</dt><dd><ul class="simple">
<li><p>in a <code class="docutils literal notranslate"><span class="pre">&lt;modules&gt;</span></code> subdirectory of the project directory.</p></li>
<li><p>or in a <code class="docutils literal notranslate"><span class="pre">python/&lt;modules&gt;</span></code> subdirectory of the project directory.</p></li>
</ul>
</dd>
</dl>
<p>This file contains basically the same information as <code class="docutils literal notranslate"><span class="pre">project_info.cmake</span></code> but in pyton language:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NAME</span> <span class="o">=</span> <span class="s1">&#39;soma-base&#39;</span>
<span class="n">PROJECT</span> <span class="o">=</span> <span class="s1">&#39;soma&#39;</span>      <span class="c1"># optional, taken as NAME if omitted</span>
<span class="n">MAINTAINER</span> <span class="o">=</span> <span class="s2">&quot;CEA&quot;</span>    <span class="c1"># optional</span>
<span class="n">LICENSE</span> <span class="o">=</span> <span class="s2">&quot;CeCILL-B&quot;</span>
<span class="n">version_major</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">version_minor</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">version_micro</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
<p>Other variables are of course allowed, it is a standard python files. The variables above will be translated to those of <code class="docutils literal notranslate"><span class="pre">project_infi.cmake</span></code> and will be available under the latter names in <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>PROJECT -&gt; BRAINVISA_PACKAGE_MAIN_PROJECT
NAME -&gt; BRAINVISA_PACKAGE_NAME
MAINTAINER -&gt; BRAINVISA_PACKAGE_MAINTAINER
LICENSE -&gt; BRAINVISA_PACKAGE_LICENCES
version_major -&gt; BRAINVISA_PACKAGE_VERSION_MAJOR
version_minor -&gt; BRAINVISA_PACKAGE_VERSION_MINOR
version_micro -&gt; BRAINVISA_PACKAGE_VERSION_PATCH
</pre></div>
</div>
</section>
</section>
<section id="how-to-create-version-files-with-brainvisa-cmake">
<h2>How to create version files with brainvisa-cmake<a class="headerlink" href="#how-to-create-version-files-with-brainvisa-cmake" title="Permalink to this headline">¶</a></h2>
<p>It is possible to use <em>brainvisa-cmake</em> to generate source code containing the version stored in <code class="docutils literal notranslate"><span class="pre">project_info.cmake</span></code>. Here is an example from old_connectomist project. There are two template files, one for C++ and one for Python:</p>
<p><strong>config/config.h.in:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef COMIST_VERSION_H</span>
<span class="cp">#define COMIST_VERSION_H</span>

<span class="cp">#define connectomist_version &quot;@connectomist_VERSION@&quot;</span>

<span class="cp">#endif </span><span class="c1">// ifndef COMIST_VERSION_H</span>
</pre></div>
</div>
<p><strong>config/config.py.in:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">share</span> <span class="o">=</span> <span class="s1">&#39;connectomist-@BRAINVISA_PACKAGE_VERSION_MAJOR@.@BRAINVISA_PACKAGE_VERSION_MINOR@&#39;</span>
<span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;@BRAINVISA_PACKAGE_VERSION_MAJOR@.@BRAINVISA_PACKAGE_VERSION_MINOR@.@BRAINVISA_PACKAGE_VERSION_PATCH@&#39;</span>
</pre></div>
</div>
<p>These config files are used in <code class="docutils literal notranslate"><span class="pre">CMaleLists.txt</span></code> to generate the matching <code class="docutils literal notranslate"><span class="pre">config.h</span></code> and <code class="docutils literal notranslate"><span class="pre">config.py</span></code> at configure step:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">configure_file</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/config/config.py.in&quot;</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/python/connectomist/config.py&quot;</span> <span class="s">@ONLY</span> <span class="p">)</span>
<span class="nb">BRAINVISA_INSTALL</span><span class="p">(</span> <span class="s">FILES</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/python/connectomist/config.py&quot;</span>
                  <span class="s">DESTINATION</span> <span class="s2">&quot;python/connectomist&quot;</span>
                  <span class="s">COMPONENT</span> <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>
<span class="nb">configure_file</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/config/config.h.in&quot;</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/include/connectomist/config.h&quot;</span> <span class="s">@ONLY</span> <span class="p">)</span>
<span class="nb">BRAINVISA_INSTALL</span><span class="p">(</span> <span class="s">FILES</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/include/connectomist/config.h&quot;</span>
                  <span class="s">DESTINATION</span> <span class="s2">&quot;include/connectomist&quot;</span>
                  <span class="s">COMPONENT</span> <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">-dev</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cmakelists-txt">
<h2>CMakeLists.txt<a class="headerlink" href="#cmakelists-txt" title="Permalink to this headline">¶</a></h2>
<p>This file is used by <a class="reference external" href="http://www.cmake.org">CMake</a> to generate the <code class="docutils literal notranslate"><span class="pre">Makefiles</span></code> that will be used to build the project.</p>
<p>This file is written in the CMake specific language. See <a class="reference external" href="https://cmake.org/documentation">CMake documentation</a> for more information.</p>
<p>On top of the classic CMake functions, we defined functions in <em>brainvisa-cmake</em> that help defining <code class="docutils literal notranslate"><span class="pre">CMakeLists</span></code> files for Brainvisa projects. These functions names start with <code class="docutils literal notranslate"><span class="pre">BRAINVISA_</span></code> and are defined in the file <code class="docutils literal notranslate"><span class="pre">brainvisa-cmake-config.cmake.in</span></code> in <em>brainvisa-cmake</em> project.</p>
<p><strong>Example:</strong> <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> of <em>morphologist-gpl</em> component of the <em>morphologist</em> project.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span> <span class="s">VERSION</span> <span class="s">2.6</span> <span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span> <span class="s">brainvisa-cmake</span> <span class="s">REQUIRED</span> <span class="p">)</span>
<span class="nb">BRAINVISA_PROJECT</span><span class="p">()</span>

<span class="nb">BRAINVISA_COPY_PYTHON_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/brainvisa&quot;</span>
                                 <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>

<span class="nb">BRAINVISA_COPY_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/doc&quot;</span>
                          <span class="s2">&quot;share/doc/t1mri-${${PROJECT_NAME}_VERSION_MAJOR}.${${PROJECT_NAME}_VERSION_MINOR}&quot;</span>
                          <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">-usrdoc</span> <span class="p">)</span>

<span class="nb">BRAINVISA_CREATE_CMAKE_CONFIG_FILES</span><span class="p">()</span>
</pre></div>
</div>
<p>The first 3 lines are mandatory, they check the version of cmake, search for brainvisa_cmake project and initialize the current project information reading the project_info.cmake file.</p>
<p>The rest of the file depends on the content of the component. In the previous example, t1mri-gpl only contains a Brainvisa toolbox (python files) and some documentation. The Brainvisa toolbox files and the documentation will be linked in the build directory.</p>
<p>The last line is useful only if the component is a dependency of another one. If so, you need to write 2 more files in a cmake directory: <code class="docutils literal notranslate"><span class="pre">&lt;component&gt;-config.cmake.in</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;component&gt;-use.cmake.in</span></code>.</p>
</section>
<section id="brainvisa-cmake-functions">
<h2>brainvisa-cmake functions<a class="headerlink" href="#brainvisa-cmake-functions" title="Permalink to this headline">¶</a></h2>
<p>Here is a glimpse of the <em>brainvisa-cmake</em> helper functions which can be used in the <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> files.</p>
<section id="c">
<h3>C++<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-get-file-list-from-pro">
<h4>BRAINVISA_GET_FILE_LIST_FROM_PRO<a class="headerlink" href="#brainvisa-get-file-list-from-pro" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GET_FILE_LIST_FROM_PRO</span><span class="p">(</span> <span class="s">proFilename</span> <span class="s">&lt;pro</span> <span class="s">variable&gt;</span> <span class="s">&lt;cmake</span> <span class="s">variable&gt;</span> <span class="s">[&lt;pro</span> <span class="s">variable&gt;</span> <span class="s">&lt;cmake</span> <span class="s">variable&gt;...]</span> <span class="p">)</span>
</pre></div>
</div>
<p>This function was useful when we switched from our home made tool <em>build-config</em> to cmake because build-config used <code class="docutils literal notranslate"><span class="pre">.pro</span></code> files (similar to Qt’s Qmake) containing the list of headers and sources files needed to build a target. With this function, existing <code class="docutils literal notranslate"><span class="pre">.pro</span></code> files can be reused in <code class="docutils literal notranslate"><span class="pre">CMakeLists</span></code> files.</p>
<p><strong>Example</strong></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GET_FILE_LIST_FROM_PRO</span><span class="p">(</span> <span class="s2">&quot;${_pro}&quot;</span>
                                  <span class="s">TARGET</span> <span class="s">_target</span>
                                  <span class="s">SOURCES</span> <span class="s">_proSources</span> <span class="p">)</span>
</pre></div>
</div>
<p><em>_target</em> variable contains the name of the lib or executable target.</p>
<p><em>_proSources</em> variable contains the name of C++ source files.</p>
</section>
<section id="brainvisa-copy-and-install-headers">
<h4>BRAINVISA_COPY_AND_INSTALL_HEADERS<a class="headerlink" href="#brainvisa-copy-and-install-headers" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_AND_INSTALL_HEADERS</span><span class="p">(</span> <span class="s">&lt;headers</span> <span class="s">list&gt;</span> <span class="s">&lt;include</span> <span class="s">directory&gt;</span> <span class="s">&lt;target_variable&gt;</span> <span class="s">[NO_SYMLINKS]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Copies or creates symlinks on the header files in the include directory of the build directory.</p>
<p><strong>Example:</strong> from anatomist library’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GET_FILE_LIST_FROM_PRO</span><span class="p">(</span> <span class="s">project.pro</span> <span class="s2">&quot;HEADERS&quot;</span> <span class="s">_headers</span> <span class="s2">&quot;SOURCES&quot;</span> <span class="s">_sources</span> <span class="p">)</span>
<span class="nb">BRAINVISA_COPY_AND_INSTALL_HEADERS</span><span class="p">(</span> <span class="s">_headers</span> <span class="s">anatomist</span> <span class="s">headersTarget</span> <span class="p">)</span>
<span class="nb">add_library</span><span class="p">(</span> <span class="s">anatomist</span> <span class="s">SHARED</span> <span class="o">${</span><span class="nv">_sources</span><span class="o">}</span> <span class="p">)</span>
<span class="nb">add_dependencies</span><span class="p">(</span> <span class="s">anatomist</span> <span class="o">${</span><span class="nv">headersTarget</span><span class="o">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>The list of header and source files is extracted from the <code class="docutils literal notranslate"><span class="pre">project.pro</span></code> file. The headers are linked in <code class="docutils literal notranslate"><span class="pre">&lt;build_directory&gt;/include/anatomist</span></code>. The anatomist shared library is created from the source files. A dependency is added between the creation of the library and the copy of the headers.</p>
</section>
</section>
<section id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-copy-python-directory">
<h4>BRAINVISA_COPY_PYTHON_DIRECTORY<a class="headerlink" href="#brainvisa-copy-python-directory" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_PYTHON_DIRECTORY</span> <span class="p">(</span> <span class="s">&lt;python</span> <span class="s">directory&amp;gt</span> <span class="s">&lt;component&gt;</span> <span class="s">[&lt;destination</span> <span class="s">directory&gt;]</span> <span class="s">[NO_SYMLINKS]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Create targets to copy, byte compile and install all Python code contained in a directory. If the destination directory is not set, the right most directory name in the python directory is used.</p>
<p><strong>Example:</strong> from axon’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_PYTHON_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/python&quot;</span>
                                 <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>
<span class="nb">BRAINVISA_COPY_PYTHON_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/brainvisa&quot;</span>
                                 <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">python</span></code> directory in source directory will be linked in the <code class="docutils literal notranslate"><span class="pre">python</span></code> directory of the build directory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">brainvisa</span></code> directory in source directory will be linked in the <code class="docutils literal notranslate"><span class="pre">brainvisa</span></code> directory of the build directory.</p>
</section>
</section>
<section id="sip">
<h3>SIP<a class="headerlink" href="#sip" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-add-sip-python-module">
<h4>BRAINVISA_ADD_SIP_PYTHON_MODULE<a class="headerlink" href="#brainvisa-add-sip-python-module" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_ADD_SIP_PYTHON_MODULE</span><span class="p">(</span> <span class="s">&lt;module&gt;</span> <span class="s">&lt;directory&gt;</span> <span class="s">&lt;mainSipFile&gt;</span> <span class="s">[</span> <span class="s">SIP_SOURCES</span> <span class="s">&lt;file&gt;</span> <span class="s">...</span> <span class="s">]</span> <span class="s">[</span> <span class="s">SIP_INCLUDE</span> <span class="s">&lt;directory&gt;</span> <span class="s">...</span> <span class="s">]</span> <span class="s">[</span> <span class="s">SIP_INSTALL</span> <span class="s">&lt;directory&gt;</span> <span class="s">]</span> <span class="p">)</span>
</pre></div>
</div>
<p><strong>Example:</strong> from pyanatomist’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_ADD_SIP_PYTHON_MODULE</span><span class="p">(</span> <span class="s">anatomistsip</span>
    <span class="s">anatomist/cpp</span>
    <span class="s2">&quot;${CMAKE_BINARY_DIR}/${ANATOMIST_RELATIVE_SIP_DIRECTORY}/anatomist_VOID.sip&quot;</span>
    <span class="s">SIP_SOURCES</span> <span class="o">${</span><span class="nv">_generatedSipFileList</span><span class="o">}</span> <span class="o">${</span><span class="nv">_sipSources</span><span class="o">}</span>
    <span class="s">SIP_INCLUDE</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/${ANATOMIST_RELATIVE_SIP_DIRECTORY}&quot;</span>
      <span class="s2">&quot;${AIMS-FREE_SIP_DIRECTORY}&quot;</span> <span class="s2">&quot;${PYQT${DESIRED_QT_VERSION}_SIP_DIR}&quot;</span>
    <span class="s">SIP_INSTALL</span> <span class="s2">&quot;${ANATOMIST_RELATIVE_SIP_DIRECTORY}&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>A library named <em>anatomistsip</em> will be created in <code class="docutils literal notranslate"><span class="pre">python/anatomist/cpp</span></code> directory in build directory from the sources files indicated.</p>
</section>
</section>
<section id="qt">
<h3>Qt<a class="headerlink" href="#qt" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-add-moc-files">
<h4>BRAINVISA_ADD_MOC_FILES<a class="headerlink" href="#brainvisa-add-moc-files" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>BRAINVISA_ADD_MOC_FILES &lt;result variable&gt; &lt;header files&gt;
</pre></div>
</div>
<p>Creates a makefile target to generate the C++ code needed to replace <code class="docutils literal notranslate"><span class="pre">Q_OBJECT</span></code> macro. It uses the Qt Meta-Object compiler (moc).</p>
<p><strong>Example:</strong> from anatomist library’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>BRAINVISA_GET_FILE_LIST_FROM_PRO( project.pro &quot;HEADERS&quot; _headers &quot;SOURCES&quot; _sources )
BRAINVISA_ADD_MOC_FILES( _sources ${_headers} )
add_library( anatomist SHARED ${_sources} )

The files generated by moc will be added to the source files used to generate anatomist library.
</pre></div>
</div>
</section>
<section id="brainvisa-add-translation">
<h4>BRAINVISA_ADD_TRANSLATION<a class="headerlink" href="#brainvisa-add-translation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>BRAINVISA_ADD_TRANSLATION &lt;source_share_dir&gt; &lt;dest_share_dir&gt; &lt;component&gt;
</pre></div>
</div>
<p>Searches recursively qt linguist source files (<code class="docutils literal notranslate"><span class="pre">*.ts</span></code>) in the source share directory and generates the commands to create the associated <code class="docutils literal notranslate"><span class="pre">*.qm</span></code> files in the build share directory and creates associated install rules.</p>
<p><strong>Example:</strong> from anatomist-free’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_ADD_TRANSLATION</span><span class="p">(</span> <span class="s2">&quot;shared&quot;</span> <span class="s2">&quot;share/anatomist-${${PROJECT_NAME}_VERSION_MAJOR}.${${PROJECT_NAME}_VERSION_MINOR}&quot;</span> <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="files-and-directories">
<h3>Files and directories<a class="headerlink" href="#files-and-directories" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-copy-files">
<h4>BRAINVISA_COPY_FILES<a class="headerlink" href="#brainvisa-copy-files" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_FILES</span><span class="p">(</span> <span class="s">&lt;component&gt;</span> <span class="s">&lt;source</span> <span class="s">files&gt;</span> <span class="s">[SOURCE_DIRECTORY</span> <span class="s">&lt;directory&gt;]</span> <span class="s">DESTINATION</span> <span class="s">&lt;destination</span> <span class="s">directory&gt;</span> <span class="s">[IMMEDIATE]</span> <span class="s">[GET_TARGET</span> <span class="s">&lt;target</span> <span class="s">variable&gt;][GET_OUTPUT_FILES</span> <span class="s">&lt;target</span> <span class="s">variable&gt;]</span> <span class="s">[NO_SYMLINKS]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Copies a list of files from the source directory to a directory in the build directory.</p>
<p><strong>Example:</strong> from cartodata’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_FILES</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">-devdoc</span> <span class="o">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="o">}</span><span class="s">/changelog.html</span>
    <span class="s">DESTINATION</span> <span class="s">share/doc/cartodata-</span><span class="o">${</span><span class="nv">${PROJECT_NAME</span><span class="o">}</span><span class="s">_VERSION_MAJOR}.</span><span class="o">${</span><span class="nv">${PROJECT_NAME</span><span class="o">}</span><span class="s">_VERSION_MINOR}/doxygen</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="brainvisa-copy-directory">
<h4>BRAINVISA_COPY_DIRECTORY<a class="headerlink" href="#brainvisa-copy-directory" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_DIRECTORY</span><span class="p">(</span> <span class="s">&lt;source</span> <span class="s">directory&gt;</span> <span class="s">&lt;destination</span> <span class="s">directory&gt;</span> <span class="s">&lt;component&gt;</span> <span class="s">[IMMEDIATE]</span> <span class="s">[GET_TARGET</span> <span class="s">&lt;target</span> <span class="s">variable&gt;]</span> <span class="s">[NO_SYMLINKS]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Recursively copies and installs all files in <code class="docutils literal notranslate"><span class="pre">&lt;source</span> <span class="pre">directory&gt;</span></code> except files named <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">*~</span></code>, <code class="docutils literal notranslate"><span class="pre">*/.svn/*</span></code>, <code class="docutils literal notranslate"><span class="pre">*.odt</span></code>, <code class="docutils literal notranslate"><span class="pre">*.odp</span></code>, <code class="docutils literal notranslate"><span class="pre">*.doc</span></code>, <code class="docutils literal notranslate"><span class="pre">*.sdw</span></code>, <code class="docutils literal notranslate"><span class="pre">*.sxw</span></code>.</p>
<p><strong>Example:</strong> from axon’s <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_COPY_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/share&quot;</span>
                          <span class="s2">&quot;share/${PROJECT_NAME}-${BRAINVISA_PACKAGE_VERSION_MAJOR}.${BRAINVISA_PACKAGE_VERSION_MINOR}&quot;</span>
                          <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>
<span class="nb">BRAINVISA_COPY_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/doc&quot;</span>
                          <span class="s2">&quot;share/doc/${PROJECT_NAME}-${BRAINVISA_PACKAGE_VERSION_MAJOR}.${BRAINVISA_PACKAGE_VERSION_MINOR}&quot;</span>
                          <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">-usrdoc</span> <span class="p">)</span>
<span class="nb">BRAINVISA_COPY_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/bin&quot;</span>
                          <span class="s">bin</span>
                          <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>
<span class="nb">BRAINVISA_COPY_DIRECTORY</span><span class="p">(</span> <span class="s2">&quot;${CMAKE_CURRENT_SOURCE_DIR}/scripts&quot;</span>
                          <span class="s">scripts</span>
                          <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span> <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-generate-doxygen-doc">
<h4>BRAINVISA_GENERATE_DOXYGEN_DOC<a class="headerlink" href="#brainvisa-generate-doxygen-doc" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GENERATE_DOXYGEN_DOC</span><span class="p">(</span> <span class="s">&lt;input_variable&gt;</span> <span class="s">[&lt;file</span> <span class="s">to</span> <span class="s">copy&gt;</span> <span class="s">...]</span> <span class="s">[INPUT_PREFIX</span> <span class="s">&lt;path&gt;]</span> <span class="s">[COMPONENT</span> <span class="s">&lt;name&gt;]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Adds rules to generate doxygen documentation (documentation of C++ source files) with “make doc” or “make devdoc”.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input_variable&gt;</span></code>: variable containing a string or a list of input sources.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;file</span> <span class="pre">to</span> <span class="pre">copy&gt;</span></code>: file (relative to <code class="docutils literal notranslate"><span class="pre">${CMAKE_CURRENT_SOURCE_DIR}</span></code>) to copy in the build tree. Files are copied in <code class="docutils literal notranslate"><span class="pre">${DOXYGEN_BINARY_DIR}</span></code> if defined, otherwise they are copied in <code class="docutils literal notranslate"><span class="pre">${PROJECT_BINARY_DIR}/doxygen</span></code>. The doxygen configuration file is generated in the same directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">prefix&gt;</span></code>: directory where finding input files</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">&lt;component&gt;</span></code>: component name for this doxygen documentation. it is used to create the output directory and the tag file name. By default it is the <code class="docutils literal notranslate"><span class="pre">PROJECT_NAME</span></code>. But it is useful to give an alternative name when there are several libraries documented with doxygen in the same project.</p>
<p>Before calling this function, it is possible to specify values that are going to be written in doxygen configuration file by setting variable names <code class="docutils literal notranslate"><span class="pre">DOXYFILE_&lt;doxyfile</span> <span class="pre">variable</span> <span class="pre">name&gt;</span></code>. For instance, in order to set project name in Doxygen, one should use:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>SET( DOXYFILE_PROJECT_NAME, &quot;My wonderful project&quot; ).
</pre></div>
</div>
<p><strong>Example:</strong> from cartodata’s <code class="docutils literal notranslate"><span class="pre">CMakeLists</span></code></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">FIND_PACKAGE</span><span class="p">(</span> <span class="s">Doxygen</span> <span class="p">)</span>
<span class="nb">IF</span> <span class="p">(</span> <span class="s">DOXYGEN_FOUND</span> <span class="p">)</span>
    <span class="nb">SET</span><span class="p">(</span><span class="s">component_name</span> <span class="s2">&quot;cartodata&quot;</span><span class="p">)</span>
    <span class="nb">set</span><span class="p">(</span> <span class="s">DOXYFILE_PREDEFINED</span> <span class="s2">&quot;${AIMS_DEFINITIONS}&quot;</span><span class="p">)</span>
    <span class="nb">set</span><span class="p">(</span><span class="s">aims_version</span> <span class="s2">&quot;${${PROJECT_NAME}_VERSION_MAJOR}.${${PROJECT_NAME}_VERSION_MINOR}&quot;</span><span class="p">)</span>
    <span class="nb">set</span><span class="p">(</span> <span class="s">DOXYFILE_TAGFILES</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/share/doc/cartobase-${aims_version}/doxygen/cartobase.tag=../../cartobase-${aims_version}/doxygen&quot;</span><span class="p">)</span>
    <span class="nb">BRAINVISA_GENERATE_DOXYGEN_DOC</span><span class="p">(</span> <span class="s">_headers</span>
                                    <span class="s">INPUT_PREFIX</span> <span class="s2">&quot;${CMAKE_BINARY_DIR}/include/${component_name}&quot;</span>
                                    <span class="s">COMPONENT</span> <span class="s2">&quot;${component_name}&quot;</span><span class="p">)</span>
    <span class="nb">add_dependencies</span><span class="p">(</span> <span class="o">${</span><span class="nv">component_name</span><span class="o">}</span><span class="s">-doxygen</span> <span class="s">cartobase-doxygen</span> <span class="p">)</span>
<span class="nb">ENDIF</span> <span class="p">(</span> <span class="s">DOXYGEN_FOUND</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="brainvisa-generate-epydoc-doc">
<h4>BRAINVISA_GENERATE_EPYDOC_DOC<a class="headerlink" href="#brainvisa-generate-epydoc-doc" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GENERATE_EPYDOC_DOC</span><span class="p">(</span> <span class="s">&lt;source</span> <span class="s">directory&gt;</span> <span class="s">[</span> <span class="s">&lt;source</span> <span class="s">directory&gt;</span> <span class="s">...</span> <span class="s">]</span> <span class="s">&lt;output</span> <span class="s">directory&gt;</span> <span class="s">[</span> <span class="s">EXCLUDE</span> <span class="s">&lt;exclude</span> <span class="s">list&gt;</span> <span class="s">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Generates documentation for python source files with Epydoc. No longer used, we write sphinx doc now.</p>
</section>
<section id="brainvisa-generate-sphinx-doc">
<h4>BRAINVISA_GENERATE_SPHINX_DOC<a class="headerlink" href="#brainvisa-generate-sphinx-doc" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GENERATE_SPHINX_DOC</span><span class="p">(</span> <span class="s">&lt;source</span> <span class="s">directory&gt;</span> <span class="s">&lt;output</span> <span class="s">directory&gt;</span> <span class="s">[TARGET</span> <span class="s">&lt;target_name&gt;]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Generates documentation for python source files with Sphinx.</p>
<p><strong>Example:</strong> from axon’s CMakeLists</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GENERATE_SPHINX_DOC</span><span class="p">(</span> <span class="s2">&quot;sphinxdoc/sphinx&quot;</span>
    <span class="s2">&quot;share/doc/axon-${BRAINVISA_PACKAGE_VERSION_MAJOR}.${BRAINVISA_PACKAGE_VERSION_MINOR}/sphinx&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="brainvisa-generate-docbook-doc">
<h4>BRAINVISA_GENERATE_DOCBOOK_DOC<a class="headerlink" href="#brainvisa-generate-docbook-doc" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_GENERATE_DOCBOOK_DOC</span><span class="p">(</span> <span class="s">[EXCLUDE</span> <span class="s">&lt;docbook_project_name&gt;]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Generates docbook documentation. No longer used either, we are using sphinx.</p>
</section>
</section>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<section id="brainvisa-create-cmake-config-files">
<h4>BRAINVISA_CREATE_CMAKE_CONFIG_FILES<a class="headerlink" href="#brainvisa-create-cmake-config-files" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_CREATE_CMAKE_CONFIG_FILES</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="brainvisa-find-package">
<h4>BRAINVISA_FIND_PACKAGE<a class="headerlink" href="#brainvisa-find-package" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_FIND_PACKAGE</span><span class="p">(</span> <span class="s">&lt;component&gt;</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="brainvisa-dependency">
<h4>BRAINVISA_DEPENDENCY<a class="headerlink" href="#brainvisa-dependency" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_DEPENDENCY</span><span class="p">(</span> <span class="s">&lt;pack_type&gt;</span> <span class="s">&lt;dependency_type&gt;</span> <span class="s">&lt;component&gt;</span> <span class="s">&lt;component_pack_type&gt;</span> <span class="s">[</span> <span class="s">&lt;version</span> <span class="s">ranges&gt;</span> <span class="s">]</span> <span class="s">[BINARY_INDEPENDENT]</span> <span class="p">)</span>
</pre></div>
</div>
<p>This function enables to declare that the current brainvisa component has a dependency on another component. That other component can be a Brainvisa component or a thirdparty dependency.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;pack_type&gt;</span></code>: type of package which have this dependency. Indeed, the compilation and runtime dependencies are not necessary the same. Can be <code class="docutils literal notranslate"><span class="pre">RUN</span></code> for runtime package, <code class="docutils literal notranslate"><span class="pre">DEV</span></code> for development package or <code class="docutils literal notranslate"><span class="pre">DOC</span></code> for documenation package.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;dependency_type&gt;</span></code>: indicates if the dependency is mandatory or not. Can be <code class="docutils literal notranslate"><span class="pre">DEPENDS</span></code> or <code class="docutils literal notranslate"><span class="pre">RECOMMENDS</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;component&gt;</span></code>: name of the dependency component.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;component_pack_type&gt;</span></code>: type of package for the dependency package: <code class="docutils literal notranslate"><span class="pre">RUN</span></code>, <code class="docutils literal notranslate"><span class="pre">DEV</span></code> or <code class="docutils literal notranslate"><span class="pre">DOC</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;version</span> <span class="pre">ranges&gt;</span></code>: required version of the dependency package.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BINARY_INDEPENDENT</span></code> can be added to indicate that the component and its dependency are binary independent (dependency between python modules for example) but this information is not used currently.</p></li>
</ul>
<p>At configuration time, the information declared in this function will be written in a file named <code class="docutils literal notranslate"><span class="pre">compilation_info.py</span></code> in the directory <code class="docutils literal notranslate"><span class="pre">&lt;build_directory&gt;/python/brainvisa</span></code>. This file is used by the <a class="reference internal" href="bv_packaging.html"><span class="doc">bv_packaging</span></a> script to create Brainvisa packages with the needed dependencies.</p>
<p><strong>Examples</strong> (from anatomist-free <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>)</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_DEPENDENCY</span><span class="p">(</span> <span class="s">RUN</span> <span class="s">DEPENDS</span> <span class="s">aims-gpl</span> <span class="s">RUN</span> <span class="s2">&quot;= ${aims-gpl_VERSION}&quot;</span> <span class="p">)</span>
<span class="nb">BRAINVISA_DEPENDENCY</span><span class="p">(</span> <span class="s">DEV</span> <span class="s">DEPENDS</span> <span class="s">aims-gpl</span> <span class="s">DEV</span> <span class="p">)</span>
<span class="nb">BRAINVISA_DEPENDENCY</span><span class="p">(</span> <span class="s">RUN</span> <span class="s">DEPENDS</span> <span class="s">libqtcore4</span> <span class="s">RUN</span> <span class="s2">&quot;&gt;= ${QT_VERSION}&quot;</span> <span class="p">)</span>
<span class="nb">BRAINVISA_DEPENDENCY</span><span class="p">(</span> <span class="s">DEV</span> <span class="s">DEPENDS</span> <span class="s">libqtcore4</span> <span class="s">DEV</span> <span class="p">)</span>
<span class="nb">BRAINVISA_DEPENDENCY</span><span class="p">(</span> <span class="s">RUN</span> <span class="s">DEPENDS</span> <span class="s">libqwt5-qt4</span> <span class="s">RUN</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h3>
<p>Install rules will be used by <a class="reference internal" href="bv_packaging.html"><span class="doc">bv_packaging</span></a> script to create Brainvisa packages.</p>
<p>Be careful, if you want to use directly the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> command to install files of the build directory in another location, you’ll have to specify the variable <code class="docutils literal notranslate"><span class="pre">BRAINVISA_INSTALL_PREFIX</span></code> in the make install command. Indeed, to be able to specify an install location when using <a class="reference internal" href="bv_packaging.html"><span class="doc">bv_packaging</span></a> script, we had to use a variable that have to be defined at installation step instead of the <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX</span></code> which is defined at configuration step.</p>
<p><strong>Example</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">BRAINVISA_INSTALL_PREFIX</span><span class="o">=</span>/tmp/test install-aims-gpl
</pre></div>
</div>
<section id="brainvisa-install-directory">
<h4>BRAINVISA_INSTALL_DIRECTORY<a class="headerlink" href="#brainvisa-install-directory" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_INSTALL_DIRECTORY</span><span class="p">(</span> <span class="s">directory</span> <span class="s">destination</span> <span class="s">component</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="brainvisa-install">
<h4>BRAINVISA_INSTALL<a class="headerlink" href="#brainvisa-install" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>BRAINVISA_INSTALL
</pre></div>
</div>
</section>
<section id="brainvisa-install-runtime-libraries">
<h4>BRAINVISA_INSTALL_RUNTIME_LIBRARIES<a class="headerlink" href="#brainvisa-install-runtime-libraries" title="Permalink to this headline">¶</a></h4>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">BRAINVISA_INSTALL_RUNTIME_LIBRARIES</span><span class="p">(</span> <span class="s">component</span> <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">How to compile a new project with brainvisa-cmake</a><ul>
<li><a class="reference internal" href="#project-info-cmake">Project_info.cmake</a><ul>
<li><a class="reference internal" href="#variables">Variables</a><ul>
<li><a class="reference internal" href="#brainvisa-package-default-install">BRAINVISA_PACKAGE_DEFAULT_INSTALL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#info-py-alternative">Info.py alternative</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-create-version-files-with-brainvisa-cmake">How to create version files with brainvisa-cmake</a></li>
<li><a class="reference internal" href="#cmakelists-txt">CMakeLists.txt</a></li>
<li><a class="reference internal" href="#brainvisa-cmake-functions">brainvisa-cmake functions</a><ul>
<li><a class="reference internal" href="#c">C++</a><ul>
<li><a class="reference internal" href="#brainvisa-get-file-list-from-pro">BRAINVISA_GET_FILE_LIST_FROM_PRO</a></li>
<li><a class="reference internal" href="#brainvisa-copy-and-install-headers">BRAINVISA_COPY_AND_INSTALL_HEADERS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python">Python</a><ul>
<li><a class="reference internal" href="#brainvisa-copy-python-directory">BRAINVISA_COPY_PYTHON_DIRECTORY</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sip">SIP</a><ul>
<li><a class="reference internal" href="#brainvisa-add-sip-python-module">BRAINVISA_ADD_SIP_PYTHON_MODULE</a></li>
</ul>
</li>
<li><a class="reference internal" href="#qt">Qt</a><ul>
<li><a class="reference internal" href="#brainvisa-add-moc-files">BRAINVISA_ADD_MOC_FILES</a></li>
<li><a class="reference internal" href="#brainvisa-add-translation">BRAINVISA_ADD_TRANSLATION</a></li>
</ul>
</li>
<li><a class="reference internal" href="#files-and-directories">Files and directories</a><ul>
<li><a class="reference internal" href="#brainvisa-copy-files">BRAINVISA_COPY_FILES</a></li>
<li><a class="reference internal" href="#brainvisa-copy-directory">BRAINVISA_COPY_DIRECTORY</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation">Documentation</a><ul>
<li><a class="reference internal" href="#brainvisa-generate-doxygen-doc">BRAINVISA_GENERATE_DOXYGEN_DOC</a></li>
<li><a class="reference internal" href="#brainvisa-generate-epydoc-doc">BRAINVISA_GENERATE_EPYDOC_DOC</a></li>
<li><a class="reference internal" href="#brainvisa-generate-sphinx-doc">BRAINVISA_GENERATE_SPHINX_DOC</a></li>
<li><a class="reference internal" href="#brainvisa-generate-docbook-doc">BRAINVISA_GENERATE_DOCBOOK_DOC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li><a class="reference internal" href="#brainvisa-create-cmake-config-files">BRAINVISA_CREATE_CMAKE_CONFIG_FILES</a></li>
<li><a class="reference internal" href="#brainvisa-find-package">BRAINVISA_FIND_PACKAGE</a></li>
<li><a class="reference internal" href="#brainvisa-dependency">BRAINVISA_DEPENDENCY</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install">Install</a><ul>
<li><a class="reference internal" href="#brainvisa-install-directory">BRAINVISA_INSTALL_DIRECTORY</a></li>
<li><a class="reference internal" href="#brainvisa-install">BRAINVISA_INSTALL</a></li>
<li><a class="reference internal" href="#brainvisa-install-runtime-libraries">BRAINVISA_INSTALL_RUNTIME_LIBRARIES</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="previous chapter">The bv_maker.cfg configuration file</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dependencies.html"
                        title="next chapter">Dependencies in brainvisa-cmake</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/new_project.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="dependencies.html" title="Dependencies in brainvisa-cmake"
             >next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="The bv_maker.cfg configuration file"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BrainVisa-Cmake 5.1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">How to compile a new project with brainvisa-cmake</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, CEA.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>